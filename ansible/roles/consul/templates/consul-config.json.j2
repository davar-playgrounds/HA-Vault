{
  "acl": {
    "enabled": true,
    "default_policy": "deny",
    "enable_token_persistence": true
  },
{% if not consul_agent_only %}
  "bootstrap_expect": 3,
  "client_addr": "0.0.0.0",
{% endif %}
  "ca_file": "{{ consul_config_dir }}/{{ consul_ca_crt_file|basename }}",
  "cert_file": "{{ consul_config_dir }}/{{ consul_crt_file|basename }}",
  "key_file": "{{ consul_config_dir }}/{{ consul_key_file|basename }}",
  "data_dir": "{{ consul_data_dir }}",
  "datacenter": "{{ consul_datacenter }}",
  "primary_datacenter": "{{ consul_datacenter }}",
  "encrypt": "{{ consul_gossip_encryption_key }}",
  "enable_agent_tls_for_checks": true,
  "encrypt_verify_incoming": true,
  "encrypt_verify_outgoing": true,
  "leave_on_terminate": true,
  "log_json": true,
  "ports": {
    "dns": -1,
    "http": -1,
    "https": 8501
  },
  "rejoin_after_leave": true,
  "server": {{ (not consul_agent_only)|lower }},
  "server_name": "consul",
  "ui": true,
  "verify_incoming": true,
  "verify_outgoing": true,
  "verify_server_hostname": true
}
